import requests
from bs4 import BeautifulSoup

bad_char = ["'", "<", ">", "(", ")", ";"]

def spider_inputs(url):
    response = requests.get(url)
    soup = BeautifulSoup(response.text, "html.parser")
    form = soup.find('form')
    if not form:
        print("No form was found")
        return []
    #Check for the password field
    password_inputs = form.find('input', {'type': 'password'})
    username_inputs = form.find('input', {'type': 'text'})
    if not password_inputs or not username_inputs:
        print("No password or username field was found")
    return {
        'username_inputs': username_inputs.get('name'),
        'password_inputs': password_inputs.get('name')
    }

def test_inputs(url, inputs, username):
    results = {}
    username_name = inputs['username_inputs']
    password_name = inputs['password_inputs']

    for i in bad_char:
        payload = {username_name: username, password_name: i}
        response = requests.post(url, data=payload)
        key = f"{url} username: {username} payload {i}"
        results[key] = response.status_code
    return results

def main():
    url = input("URL to scan: ")
    username = input("What username would you like to test?")
    inputs = spider_inputs(url)
    if not inputs:
        return
    
    results = test_inputs(url, inputs, username)
    for key, value in results.items():
        print(f"{key} and status code {value}")

if __name__ == "__main__":
    main()